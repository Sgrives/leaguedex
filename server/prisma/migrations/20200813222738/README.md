# Migration `20200813222738`

This migration has been generated by Donny Roufs at 8/14/2020, 12:27:38 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Token.username_unique"

ALTER TABLE "public"."Note" DROP CONSTRAINT "Note_matchupId_fkey"

ALTER TABLE "public"."Note" DROP CONSTRAINT "Note_user_id_fkey"

ALTER TABLE "public"."Champion" DROP COLUMN "lore",
DROP COLUMN "tags",
ADD COLUMN "updatedAt" timestamp(3)  NOT NULL ;

ALTER TABLE "public"."Token" DROP COLUMN "username",
ADD COLUMN "user_id" text  NOT NULL ,
ADD COLUMN "userId" integer   ;

CREATE UNIQUE INDEX "Token.user_id_unique" ON "public"."Token"("user_id")

ALTER TABLE "public"."Token" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

DROP TABLE "public"."Note";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200813201546-change-authentication-to-token..20200813222738
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -14,26 +14,15 @@
   id          Int       @id @default(autoincrement())
   email       String    @unique
   username    String    @unique
   password    String
-  notes       Note[]
   summoner    Summoner?
   permissions Int       @default(1)
   createdAt   DateTime  @default(now())
   updatedAt   DateTime  @updatedAt
+  Token       Token[]
 }
-model Note {
-  id        Int      @id @default(autoincrement())
-  body      String
-  User      User?    @relation(fields: [user_id], references: [id])
-  user_id   Int?
-  Matchup   Matchup? @relation(fields: [matchupId], references: [id])
-  matchupId Int?
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
-}
-
 model Summoner {
   id        Int       @id @default(autoincrement())
   accountId String
   name      String
@@ -51,9 +40,8 @@
   champion_one String
   champion_two String
   games_played Int       @default(0)
   lane         String?
-  notes        Note[]
   Summoner     Summoner? @relation(fields: [summoner_id], references: [id])
   summoner_id  Int?
   createdAt    DateTime  @default(now())
   updatedAt    DateTime  @updatedAt
@@ -62,17 +50,18 @@
 model Champion {
   id        Int      @id
   name      String   @unique
   image     String
-  lore      String
-  tags      String
   version   String
   createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
 }
 model Token {
   id        Int      @id @default(autoincrement())
   token     String
-  username  String   @unique
+  user_id   String   @unique
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
+  user      User?    @relation(fields: [userId], references: [id])
+  userId    Int?
 }
```


